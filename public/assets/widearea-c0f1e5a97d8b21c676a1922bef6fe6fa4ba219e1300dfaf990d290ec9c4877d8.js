!function(t,e){"object"==typeof exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t)}(this,function(t){function e(t){this._targetElement=t,this._wideAreaId=1,this._options={wideAreaAttr:"data-widearea",exitOnEsc:!0,defaultColorScheme:"light",closeIconLabel:"Close WideArea",changeThemeIconLabel:"Toggle Color Scheme",fullScreenIconLabel:"WideArea Mode",autoSaveKeyPrefix:"WDATA-"},s.call(this)}function i(){}function n(){}function o(t){var e,i;"string"==typeof t?(e=this._targetElement.querySelector(t),e&&(i=parseInt(e.getAttribute("data-widearea-id")))):"number"==typeof t?(e=this._targetElement.querySelector('textarea[data-widearea-id="'+t+'"]'),i=t):"object"==typeof t&&(e=t,e&&(i=parseInt(e.attr("data-widearea-id")))),e&&i&&(e.val(""),localStorage.removeItem(this._options.autoSaveKeyPrefix+i))}function s(){var t=this,e=this._targetElement.querySelectorAll("textarea["+this._options.wideAreaAttr+"='enable']"),o=function(){l.call(t,this)};this._textareas=[];for(var s=e.length-1;s>=0;s--){var u=e[s],d=document.createElement("div"),c=document.createElement("div"),h=document.createElement("a");d.className="widearea-wrapper",c.className="widearea-icons",h.className="widearea-icon fullscreen",h.title=this._options.fullScreenIconLabel,h.href="javascript:void(0);",h.draggable=!1,h.onclick=o,u.className+=(u.className+" widearea").replace(/^\s+|\s+$/g,""),u.setAttribute("data-widearea-id",this._wideAreaId),c.setAttribute("id","widearea-"+this._wideAreaId),n.call(this,this._wideAreaId)&&(u.value=n.call(this,this._wideAreaId));var p=function(){i.call(t,this.getAttribute("data-widearea-id"),this.value)};u.addEventListener?u.addEventListener("input",p,!1):u.attachEvent&&u.attachEvent("onpropertychange",p),++this._wideAreaId,r(u,c),c.appendChild(h),d.appendChild(c),document.body.appendChild(d),this._textareas.push(u)}this._timer=setInterval(function(){for(var e=t._textareas.length-1;e>=0;e--){var i=t._textareas[e],n=document.getElementById("widearea-"+i.getAttribute("data-widearea-id")),o=a(n),s=a(i);o.left-s.width+21==s.left&&o.top==s.top||r(i,n,s)}},200)}function r(t,e,i){var n=i||a(t);e.style.left=n.left+n.width-21+"px",e.style.top=n.top+"px"}function a(t){var e={};e.width=t.offsetWidth,e.height=t.offsetHeight;for(var i=0,n=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)i+=t.offsetLeft,n+=t.offsetTop,t=t.offsetParent;return e.top=n,e.left=i,e}function l(t){var e=this,n=parseInt(t.parentNode.id.replace(/widearea\-/,"")),o=document.querySelector("textarea[data-widearea-id='"+n+"']"),s=o.cloneNode();s.className=("widearea-fullscreen "+o.className).replace(/^\s+|\s+$/g,""),o.className=("widearea-fullscreened "+o.className).replace(/^\s+|\s+$/g,"");var r=document.createElement("div");r.className="widearea-controlPanel";var a=document.createElement("a");a.href="javascript:void(0);",a.className="widearea-icon close",a.title=this._options.closeIconLabel,a.onclick=function(){d.call(e)},a.draggable=!1;var l=document.createElement("a");l.href="javascript:void(0);",l.className="widearea-icon changeTheme",l.title=this._options.changeThemeIconLabel,l.onclick=function(){u.call(e)},l.draggable=!1,r.appendChild(a),r.appendChild(l);var c=document.createElement("div");c.className="widearea-overlayLayer "+this._options.defaultColorScheme,c.appendChild(s),c.appendChild(r),document.body.appendChild(c),s.focus(),s.value=o.value;var h=function(){i.call(e,this.getAttribute("data-widearea-id"),this.value)};s.addEventListener?s.addEventListener("input",h,!1):s.attachEvent&&s.attachEvent("onpropertychange",h),this._onKeyDown=function(t){if(27===t.keyCode&&e._options.exitOnEsc&&d.call(e),9==t.keyCode){t.preventDefault();var i=s.selectionStart;s.value=s.value.substring(0,i)+"	"+s.value.substring(s.selectionEnd),s.selectionEnd=i+1}},window.addEventListener?window.addEventListener("keydown",e._onKeyDown,!0):document.attachEvent&&document.attachEvent("onkeydown",e._onKeyDown)}function u(){var t=document.querySelector(".widearea-overlayLayer");/dark/gi.test(t.className)?t.className=t.className.replace("dark","light"):t.className=t.className.replace("light","dark")}function d(){var t=document.querySelector("textarea.widearea-fullscreened"),e=document.querySelector(".widearea-overlayLayer"),i=e.querySelector("textarea");t.focus(),t.value=i.value,t.className=t.className.replace(/widearea-fullscreened/gi,"").replace(/^\s+|\s+$/g,""),e.parentNode.removeChild(e),window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),adaptiveheight(t)}function c(t,e){var i,n={};for(i in t)n[i]=t[i];for(i in e)n[i]=e[i];return n}var h="0.3.0",p=function(t){if("string"==typeof t){var i=document.querySelector(t);if(i)return new e(i);throw new Error("There is no element with given selector.")}return new e(document.body)};return p.version=h,p.fn=e.prototype={clone:function(){return new e(this)},setOption:function(t,e){return this._options[t]=e,this},setOptions:function(t){return this._options=c(this._options,t),this},clearData:function(t){return o.call(this,t),this}},t.wideArea=p,p});